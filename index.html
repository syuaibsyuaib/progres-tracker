<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
		crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
	<style>
		.form-check-input:checked {
			background-color: #00ad17;
			border-color: #0b8000;
		}

		.main-footer {
			background-color: #fff;
			border-top: 1px solid #dee2e6;
			color: #869099;
			padding: 1rem;
		}

		.list-kegiatan {
			cursor: grab;
		}

		.ghost {
			opacity: .5;
			background: #C8EBFB;
		}

		@media (min-width: 768px) {
			.judul {
				text-align: left !important
			}

			.logo {
				min-width: 254px;
			}
		}
	</style>
</head>

<body>
	<div class="bg-warning text-light p-3">
		<div class="row align-items-center">
			<div class="col-md-2 align-middle text-center logo">
				<img src="img/DINAS PENDIDIKAN STROKE LEBAR.png" class="img-fluid w-75" style="max-width:199px">
			</div>
			<div class="col text-center judul">
				<p class="fs-1 fw-bold mb-0">Progress Tracker</p>
				<p class="fs-6 fst-italic fw-light">Atur dan pantau proyek dengan mudah</p>
			</div>
		</div>
	</div>
	<nav
		class="border-bottom border-5 border-dark border-opacity-25 navbar sticky-top navbar-expand-lg navbar-dark bg-primary mb-3">
		<div class="container-fluid">
			<a class="navbar-brand" href="#">Navbar</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
				data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item">
						<a class="nav-link active" aria-current="page" href="#">Home</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">Link</a>
					</li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
							aria-expanded="false">
							Dropdown
						</a>
						<ul class="dropdown-menu">
							<li><a class="dropdown-item" href="#">Action</a></li>
							<li><a class="dropdown-item" href="#">Another action</a></li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li><a class="dropdown-item" href="#">Something else here</a></li>
						</ul>
					</li>
					<li class="nav-item">
						<a class="nav-link disabled">Disabled</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="container">
		<div class="container">
			<div class="mb-3">
				<label class="form-label" for="nama_project">Project</label>
				<input class="form-control" type="text" placeholder="Nama" id="nama_project" required>
			</div>
			<label class="form-label" for="inp_user">Panitia</label>
			<div class="mb-3 input-group ">
				<input class="form-control" type="text" name="" id="inp_user" placeholder="Nama">
				<input class="form-control" type="number" name="" id="inp_user_nip" placeholder="NIP/NIK">
				<button type="button" class="btn btn-primary" id="add_user">+</button>
			</div>
			<ul class="list-group list-group-numbered mb-3" id="users"></ul>
			<div class="text-end">
				<button type="button" class="mb-3 btn btn-success" id="simpan_nama_project">Simpan</button>
			</div>
		</div>

		<hr>
		<!-- ISI BUDGET -->
		<section>
			<div class="text-center">
				<p class="fw-bold fs-2 mb-3">Keuangan</p>
			</div>
			<label class="form-label" for="nama_barang">Mata Anggaran</label>
			<div class="input-group mb-2">
				<input class="form-control" type="text" name="" id="nama_barang" placeholder="nama barang-jasa">
			</div>
			<div class="input-group mb-2">
				<input required class="form-control" type="number" name="" id="inp_kuantitas" placeholder="kuantitas"
					title="Kuantitas">
				<input required class="form-control" type="text" name="" id="inp_satuan" placeholder="satuan"
					title="Satuan">
				<input required class="form-control" type="number" name="" id="inp_harga" placeholder="harga satuan"
					title="Harga">
				<button type="button" class="btn btn-primary" id="tambah_budget">+</button>
			</div>
			<div class="table-responsive mt-5">
				<table class="table table-hover" id="tabel_budget">
					<thead class="bg-warning text-center align-middle">
						<tr>
							<th scope="col">No.</th>
							<th scope="col">Nama Barang/Jasa</th>
							<th scope="col">Kuantitas</th>
							<th scope="col">Satuan</th>
							<th scope="col">Harga Satuan</th>
							<th scope="col">Harga Total</th>
							<th scope="col">Hapus</th>
						</tr>
					</thead>
					<tbody>

					</tbody>
				</table>
			</div>
			<div class="text-end">
				<button type="button" class="btn btn-success" id="simpan_budget">Simpan</button>
			</div>
		</section>

		<hr>
		<!-- KEGIATAN -->
		<section>
			<div class="text-center">
				<p class="fw-bold fs-2 mb-3">
					Kegiatan
				</p>
			</div>
			<p class="fw-bold">Persiapan</p>
			<div class="input-group mb-2">
				<input class="form-control" type="text" name="" id="nama_persiapan" placeholder="nama kegiatan">
				<button type="button" class="btn btn-primary" id="tambah_persiapan">+</button>
			</div>
			<ul id="list_persiapan" class="list-group">

			</ul>
			<hr class="text-danger">
			<p class="fw-bold">Pelaksanaan</p>
			<div class="input-group mb-2">
				<input class="form-control" type="text" name="" id="nama_pelaksanaan" placeholder="nama kegiatan">
				<button type="button" class="btn btn-primary" id="tambah_pelaksanaan">+</button>
			</div>
			<ul id="list_pelaksanaan" class="list-group">

			</ul>
			<hr class="text-danger">
			<p class="fw-bold">Pelaporan</p>
			<div class="input-group mb-2">
				<input class="form-control" type="text" name="" id="nama_pelaporan" placeholder="nama kegiatan">
				<button type="button" class="btn btn-primary" id="tambah_pelaporan">+</button>
			</div>
			<ul id="list_pelaporan" class="list-group">

			</ul>
		</section>
	</div>
	<footer class="main-footer">
		<strong>Copyright Â© 2022 <a href="#">Syuaib</a>.</strong>
		All rights reserved.
		<div class="float-right d-none d-sm-inline-block">
			<b>Version</b> 1.0.0
		</div>
	</footer>

	<!-- Modal barjasTerpakai-->
	<div class="modal fade" id="modal_barjas_terpakai" tabindex="-1" aria-labelledby="modal_barjas_terpakai_label"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modal_barjas_terpakai_label">Modal title</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					...
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary">Save changes</button>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
	<script src="https://kit.fontawesome.com/923e54134a.js" crossorigin="anonymous"></script>
	<script>

		$('#add_user').click(function () {
			if (inp_user.value == '') {
				$(inp_user).focus()
				return
			} else if (inp_user_nip.value == '') {
				$(inp_user_nip).focus()
				return
			}

			$('#users').append(`<li class="list-group-item d-flex justify-content-between align-items-start">
				<div class="me-auto ms-2">
				${inp_user.value} ( ${inp_user_nip.value} )
				</div>
				<span onclick="hapusUser(this)" type="button">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</span>
				</li>`)
			$('#inp_user').val('')
			$('#inp_user_nip').val('')
		})

		function hapusUser(e) {
			$(e).parent().remove()
		}

		$('#simpan_nama_project').click(function (e) {
			if ($('#nama_project').val() == '') {
				$('#nama_project').focus()
				return
			}

			if ($('#users').children().length == 0) {
				$('#inp_user').focus()
				return
			}

			alert('tersimpan')
		})


		// ########### BUDGET ###########
		$('#inp_harga').keypress(function (e) {
			//HANYA BOLEH ANGKA DAN BACKSPACE
			if ((e.which < 48 || e.which > 57) && e.which != 8) {
				e.preventDefault()
				return false
			}
			// console.log(e.which)
			$('#inp_harga').keyup(function (e) {

				let angka = ($(e.currentTarget).val()).replace(/\./g, "")
				let hasil = rupiah(angka)
				// alert(hasil)
				$(e.currentTarget).val(hasil)
			})
		})

		function rupiah(nominal) {
			let banyakSeparator = Math.floor(nominal.length / 3)
			let banyakAngkaTerakhir = nominal.length - (banyakSeparator * 3)

			let arr = []
			for (let i = 1; i <= banyakSeparator; i++) {
				arr.push(nominal.substr(-3 * i, 3))
			}

			arr.push(nominal.substr(0, banyakAngkaTerakhir))

			let cleanArr = arr.filter((a) => a)
			// let hasil = ''
			// for(let i = arr.length - 1; i < 0; i--){
			let hasil = cleanArr.reverse().join(".")
			//}

			return hasil
		}

		$('#tambah_budget').click(function (e) {
			if (nama_barang.value == "") {
				$(nama_barang).focus()
				return
			} else if (inp_kuantitas.value == "") {
				$(inp_kuantitas).focus()
				return
			} else if (inp_satuan.value == "") {
				$(inp_satuan).focus()
				return
			} else if (inp_harga.value == "") {
				$(inp_harga).focus()
				return
			}


			$('#tabel_budget tbody').append(
				`<tr>
					<th scope="row">${$('#tabel_budget tbody tr').length + 1}</th>
					<td>${nama_barang.value}</td>
					<td>${inp_kuantitas.value}</td>
					<td>${inp_satuan.value}</td>
					<td>${inp_harga.value}</td>
					<td>${((inp_harga.value).replace(/\./g, "") * inp_kuantitas.value).toLocaleString('id-ID')}</td>
					<td class="text-center"><span onclick="hapusBudget(this)" type="button">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</span></td>
				</tr>`
			)

			nama_barang.value = ""
			inp_kuantitas.value = ""
			inp_satuan.value = ""
			inp_harga.value = ""
		})

		function hapusBudget(e) {
			$(e).parents().remove('tr')
			$('#tabel_budget tbody th').each(function (idx, item) {
				$(item).text(idx + 1)
			})
		}

		// ############## KEGIATAN ##############
		function hapusPersiapan(e) {
			$(e).parent().remove()
		}

		function listKegiatan(namaKegiatan) {
			let hasil = `<li class="list-group-item d-flex justify-content-between align-items-start list-kegiatan">
					<div class="me-auto">
						<span class="text-warning">
							<i class="fa-solid fa-grip-vertical me-2"></i>
						</span>
						<input class="form-check-input me-1" type="checkbox" value="">
						${namaKegiatan}
						<span onclick="barjasTerpakai(this)" type="button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="text-warning bi bi-plus-square" viewBox="0 0 16 16">
							<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
							<path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
						</svg>
						</span>
					</div>
					<span onclick="hapusPersiapan(this)" type="button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
							class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
							<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
							<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
						</svg>
					</span>
				</li>`
			return hasil
		}

		$(tambah_persiapan).click(function (e) {
			$(list_persiapan).append(listKegiatan($(nama_persiapan).val()))
			$(nama_persiapan).val("")
		})

		$(tambah_pelaksanaan).click(function (e) {
			$(list_pelaksanaan).append(listKegiatan($(nama_pelaksanaan).val()))
			$(nama_pelaksanaan).val("")
		})

		$(tambah_pelaporan).click(function (e) {
			$(list_pelaporan).append(listKegiatan($(nama_pelaporan).val()))
			$(nama_pelaporan).val("")
		})

		new Sortable(list_persiapan, {
			animation: 150,
			ghostClass: 'ghost'
		});
		new Sortable(list_pelaksanaan, {
			animation: 150,
			ghostClass: 'ghost'
		});
		new Sortable(list_pelaporan, {
			animation: 150,
			ghostClass: 'ghost'
		});

		
		function barjasTerpakai(e) {
			const modalBarjasTerpakai = new bootstrap.Modal('#modal_barjas_terpakai')
			modalBarjasTerpakai.show()
		}

function simpanLocal(data){
let db = {
"id" : 1,
"nama proyek": "tes proyek",
"panitia" : [
{"nama":"org1", "id":"7372"},
{"nama":"org2", "id":"19861217"},
],
"budget" : {
"uraian":[
{"nama barjas": "HVS", "kuantitas":2, "satuan": "rim", "harga satuan":65000, "total":130000},
{"nama barjas": "id card", "kuantitas":2, "satuan": "bungkus", "harga satuan":20000, "total":40000}
],
"total":170000
},
"kegiatan":{
"persiapan":[],
"pelaksanaan":[],
"pelaporan":[]
}
}

localStorage.setItem(JSON.stringify(db))
}

	</script>
</body>

</html>
