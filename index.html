<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
		crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
	<style>
		.form-check-input:checked {
			background-color: #00ad17;
			border-color: #0b8000;
		}
	</style>
</head>

<body>
	<div class="container border-bottom border-5 border-danger border-opacity-25 bg-warning text-light p-3 mb-3">
		<p class="fs-1 fw-bold mb-0">Progress Tracker</p>
		<p class="fs-6 fst-italic fw-light">Atur dan pantau proyek dengan mudah</p>
	</div>
	<div class="container">
		<div class="container">
			<div class="mb-3">
				<label class="form-label" for="nama_project">Project</label>
				<input class="form-control" type="text" placeholder="Nama" id="nama_project" required>
			</div>
			<label class="form-label" for="inp_user">Panitia</label>
			<div class="mb-3 input-group ">
				<input class="form-control" type="text" name="" id="inp_user" placeholder="Nama">
				<input class="form-control" type="number" name="" id="inp_user_nip" placeholder="NIP/NIK">
				<button type="button" class="btn btn-primary" id="add_user">+</button>
			</div>
			<ul class="list-group list-group-numbered mb-3" id="users"></ul>
			<div class="text-end">
				<button type="button" class="mb-3 btn btn-success" id="simpan_nama_project">Simpan</button>
			</div>
		</div>

		<hr>
		<!-- ISI BUDGET -->
		<section>
			<div class="text-center">
				<p class="fw-bold fs-2 mb-3">Keuangan</p>
			</div>
			<div class="input-control mb-2">
				<label class="form-label" for="tambah_budget">Mata Anggaran</label>
				<input class="form-control" type="text" name="" id="nama_barang" placeholder="nama barang-jasa">
			</div>
			<div class="input-group mb-2">
				<input required class="form-control" type="number" name="" id="inp_kuantitas" placeholder="kuantitas"
					title="Kuantitas">
				<input required class="form-control" type="text" name="" id="inp_satuan" placeholder="satuan"
					title="Satuan">
				<input required class="form-control" type="text" name="" id="inp_harga" placeholder="harga satuan"
					title="Harga">
				<button type="button" class="btn btn-primary" id="tambah_budget">+</button>
			</div>
			<table class="table table-hover mt-5 table-bordered" id="tabel_budget">
				<thead class="bg-warning">
					<tr>
						<th scope="col">No.</th>
						<th scope="col">Nama Barang/Jasa</th>
						<th scope="col">Kuantitas</th>
						<th scope="col">Satuan</th>
						<th scope="col">Harga Satuan</th>
						<th scope="col">Harga Total</th>
						<th scope="col">Hapus</th>
					</tr>
				</thead>
				<tbody>

				</tbody>
			</table>
			<div class="text-end">
				<button type="button" class="btn btn-success">Simpan</button>
			</div>
		</section>

		<hr>
		<section>
			<div class="text-center">
				<p class="fw-bold fs-2 mb-3">
					Kegiatan
				</p>
			</div>
			<p>Persiapan</p>
			<ul id="sortable" class="list-group">
				<li class="list-group-item d-flex justify-content-between align-items-start">
					<div class="me-auto">
						<i class="fa-solid fa-grip-vertical me-2"></i>
						<input class="form-check-input me-1" type="checkbox" value="">
						Item 1
					</div>
					<span onclick="hapusPersiapan(this)" type="button">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</span>
				</li>
				<li class="list-group-item d-flex justify-content-between align-items-start">
					<div class="me-auto">
						<i class="fa-solid fa-grip-vertical me-2"></i>
						<input class="form-check-input me-1" type="checkbox" value="">
						Item 2
					</div>
					<span onclick="hapusPersiapan(this)" type="button">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</span>
				</li>
				

			</ul>
			<p>Pelaksanaan</p>

			<p>Pelaporan</p>
		</section>
	</div>


	<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>
	<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
	<script src="https://kit.fontawesome.com/923e54134a.js" crossorigin="anonymous"></script>
	<script>
		$(function () {
			$("#sortable").sortable();
		});

		$('#add_user').click(function () {
			if (inp_user.value == '') {
				$(inp_user).focus()
				return
			} else if (inp_user_nip.value == '') {
				$(inp_user_nip).focus()
				return
			}

			$('#users').append(`<li class="list-group-item d-flex justify-content-between align-items-start">
				<div class="me-auto ms-2">
				${inp_user.value} ( ${inp_user_nip.value} )
				</div>
				<span onclick="hapusUser(this)" type="button">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</span>
				</li>`)
			$('#inp_user').val('')
			$('#inp_user_nip').val('')
		})

		function hapusUser(e) {
			$(e).parent().remove()
		}

		function hapusBudget(e) {
			$(e).parents().remove('tr')
			$('#tabel_budget tbody th').each(function (idx, item) {
				$(item).text(idx + 1)
			})
		}
		
		function hapusPersiapan(e) {
			$(e).parent().remove()
		}



		$('#simpan_nama_project').click(function (e) {
			if ($('#nama_project').val() == '') {
				$('#nama_project').focus()
				return
			}

			if ($('#users').children().length == 0) {
				$('#inp_user').focus()
				return
			}

			alert('tersimpan')
		})


		// BUDGET
		$('#inp_harga').keypress(function (e) {
			//HANYA BOLEH ANGKA DAN BACKSPACE
			if ((e.which < 48 || e.which > 57) && e.which != 8) {
				e.preventDefault()
				return false
			}
			// console.log(e.which)
			$('#inp_harga').keyup(function (e) {

				let angka = ($(e.currentTarget).val()).replace(/\./g, "")
				let hasil = rupiah(angka)

				$(e.currentTarget).val(hasil)
			})
		})

		function rupiah(nominal) {
			let banyakSeparator = Math.floor(nominal.length / 3)
			let banyakAngkaTerakhir = nominal.length - (banyakSeparator * 3)

			let arr = []
			for (let i = 1; i <= banyakSeparator; i++) {
				arr.push(nominal.substr(-3 * i, 3))
			}

			arr.push(nominal.substr(0, banyakAngkaTerakhir))

			let cleanArr = arr.filter((a) => a)
			// let hasil = ''
			// for(let i = arr.length - 1; i < 0; i--){
			let hasil = cleanArr.reverse().join(".")
			// }

			// console.log(hasil)
			return hasil
		}

		$('#tambah_budget').click(function (e) {
			if (nama_barang.value == "") {
				$(nama_barang).focus()
				return
			} else if (inp_kuantitas.value == "") {
				$(inp_kuantitas).focus()
				return
			} else if (inp_satuan.value == "") {
				$(inp_satuan).focus()
				return
			} else if (inp_harga.value == "") {
				$(inp_harga).focus()
				return
			}


			$('#tabel_budget tbody').append(
				`<tr>
					<th scope="row">${$('#tabel_budget tbody tr').length + 1}</th>
					<td>${nama_barang.value}</td>
					<td>${inp_kuantitas.value}</td>
					<td>${inp_satuan.value}</td>
					<td>${inp_harga.value}</td>
					<td>${((inp_harga.value).replace(/\./g, "") * inp_kuantitas.value).toLocaleString('id-ID')}</td>
					<td class="text-center"><span onclick="hapusBudget(this)" type="button">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle text-warning" viewBox="0 0 16 16">
					<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
					<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
					</svg>
				</span></td>
				</tr>`
			)

			nama_barang.value = ""
			inp_kuantitas.value = ""
			inp_satuan.value = ""
			inp_harga.value = ""
		})

	</script>
</body>

</html>